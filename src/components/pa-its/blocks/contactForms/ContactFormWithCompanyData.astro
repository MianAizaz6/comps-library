---
import SectionWrapper from '~/layouts/SectionWrapper.astro';
import Button from '~/components/ui/Button.astro';
import { Icon } from 'astro-icon/components';

interface CompanyInfo {
  title?: string;
  name: string;
  taxId: string;
  taxIdValue: string;
}

interface AddressInfo {
  title?: string;
  street: string;
  zipCode: string;
  city: string;
  country?: string;
}

interface ContactInfo {
  title?: string;
  description: string;
  email: string;
  phone: string;
}

interface FormValue {
  name?: string;
  placeholder?: string;
  optional?: boolean;
}

interface FormConfig {
  action: string;
  name: FormValue;
  company: FormValue;
  email: FormValue;
  phone: FormValue;
  message: FormValue;
  privacyPolicy: string;
}

export interface Props {
  id: string;
  company: CompanyInfo;
  address: AddressInfo;
  contact: ContactInfo;
  form: FormConfig;
}
const defaultFormConfig: FormConfig = {
  action: '#',
  name: {
    name: 'Name',
    placeholder: 'Ihr Name',
    optional: false,
  },
  company: {
    name: 'Firma',
    placeholder: 'Ihre Firma',
    optional: true,
  },
  email: {
    name: 'E-Mail',
    placeholder: 'Ihre E-Mail-Adresse',
    optional: false,
  },
  phone: {
    name: 'Telefon',
    placeholder: 'Ihre Telefonnummer',
    optional: true,
  },
  message: {
    name: 'Nachricht',
    placeholder: 'Ihre Nachricht',
    optional: false,
  },
  privacyPolicy:
    'Ich habe die <a href="/datenschutz" title="" class="font-medium text-gray-900 hover:no-underline underline dark:text-white">Datenschutzerkl√§rung</a> gelesen und akzeptiere sie.',
};

const { id, company, address, contact, form = defaultFormConfig } = Astro.props;
---

<SectionWrapper>
  <div class="flex flex-col gap-3 max-w-4xl mx-auto justify-between w-full sm:flex-row items-center sm:items-start">
    <div class="flex-1 flex justify-center flex-col items-center">
      <div
        class="inline-flex items-center justify-center w-14 h-14 mx-auto text-white bg-primary rounded-lg dark:bg-white/90 dark:text-primary"
      >
        <Icon name="material-symbols:domain-rounded" class="w-10 h-10" />
      </div>
      <h3 class="mt-4 text-xl font-bold text-gray-900 dark:text-white">{company.title}</h3>
      <p class="mt-1 text-base font-normal text-gray-500 dark:text-gray-400">
        {company.name}
      </p>
      <p class="text-base font-normal text-gray-500 dark:text-gray-400">
        {`${company.taxId} ${company.taxIdValue}`}
      </p>
    </div>

    <div class="flex-1 flex justify-center flex-col items-center">
      <div
        class="inline-flex items-center justify-center w-14 h-14 mx-auto text-white bg-primary rounded-lg dark:bg-white/90 dark:text-primary"
      >
        <Icon name="material-symbols:location-on" class="w-10 h-10" />
      </div>
      <h3 class="mt-4 text-xl font-bold text-gray-900 dark:text-white">{address.title}</h3>
      <p class="mt-1 text-base font-normal text-gray-500 dark:text-gray-400">
        {address.street}
      </p>
      <p class="text-base font-normal text-gray-500 dark:text-gray-400">
        {`${address.zipCode} ${address.city}`}
      </p>
      <p class="text-base font-normal text-gray-500 dark:text-gray-400">
        {address.country}
      </p>
    </div>

    <div class="flex-1 flex justify-center flex-col items-center">
      <div
        class="inline-flex items-center justify-center w-14 h-14 mx-auto text-white bg-primary rounded-lg dark:bg-white/90 dark:text-primary"
      >
        <Icon name="material-symbols:call" class="w-10 h-10" />
      </div>
      <h3 class="mt-4 text-xl font-bold text-gray-900 dark:text-white">{contact.title}</h3>
      <p class="mt-1 text-base font-normal text-gray-500 dark:text-gray-400 text-center">
        {contact.description}
      </p>
      <a
        href={`mailto:${contact.email}`}
        title=""
        class="block mt-1 text-base font-semibold text-gray-900 dark:text-white hover:underline"
      >
        {contact.email}
      </a>
      <a
        href={`tel:${contact.phone}`}
        title=""
        class="block mt-1 text-base font-semibold text-gray-900 dark:text-white hover:underline"
      >
        {contact.phone}
      </a>
    </div>
  </div>

  <div class="max-w-4xl mx-auto mt-8 lg:mt-24">
    <form id={id} class="grid max-w-screen-md grid-cols-2 mx-auto gap-x-8 gap-y-6" action={form.action} method="POST">
      <div class="col-span-2 sm:col-span-1">
        <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.name.name}
          <span class="text-sm">{form.name.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="text"
          id="name"
          name="name"
          class="block w-full p-3 text-sm text-gray-900 border border-gray-300 rounded-lg shadow-sm bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.name.placeholder}
          required={!form.name.optional}
        />
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="company-name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.company.name}
          <span class="text-xs">{form.company.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="text"
          id="company-name"
          name="company-name"
          class="block w-full p-3 text-sm text-gray-900 border border-gray-300 rounded-lg shadow-sm bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.company.placeholder}
          required={!form.company.optional}
        />
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.email.name}
          <span class="text-xs">{form.email.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="email"
          id="email"
          name="email"
          class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.email.placeholder}
          required={!form.email.optional}
        />
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="phone-number" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.phone.name}
          <span class="text-xs">{form.phone.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="number"
          id="phone-number"
          name="phone-number"
          class="block w-full p-3 text-sm text-gray-900 border border-gray-300 rounded-lg shadow-sm bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.phone.placeholder}
          required={!form.phone.optional}
        />
      </div>

      <div class="col-span-2">
        <label for="message" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400">
          {form.message.name}
          <span class="text-xs">{form.message.optional ? ' (optional)' : ''}</span>
        </label>
        <textarea
          id="message"
          rows="6"
          name="message"
          placeholder={form.message.placeholder}
          class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg shadow-sm border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        ></textarea>
      </div>

      <div class="col-span-2">
        <div class="flex items-start">
          <input
            type="checkbox"
            id="terms"
            name="terms"
            value=""
            class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
            required
          />
          <label
            for="terms"
            class="ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"
            set:html={form.privacyPolicy}
          />
        </div>
      </div>

      <div class="flex justify-end col-span-2">
        <Button id={`submitButtonFrom${id}`} text="Nachricht senden" submit={true} overwriteClass="me-0" />
        <Button
          id={`loadingButtonFrom${id}`}
          text="Nachricht wird gesendet..."
          overwriteClass="hidden me-0"
          loading={true}
        />
      </div>
      <slot />
    </form>
  </div>
</SectionWrapper>
