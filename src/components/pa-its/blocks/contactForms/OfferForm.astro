---
import SectionWrapper from '~/layouts/SectionWrapper.astro';
import Button from '~/components/ui/Button.astro';
import { Icon } from 'astro-icon/components';

interface FormValue {
  name?: string;
  placeholder?: string;
  optional?: boolean;
}
interface RadioOption {
  name: string;
  icon: string;
  color: string;
  value: string;
}

interface FormConfig {
  action: string;
  services: RadioOption[];
  name: FormValue;
  company: FormValue;
  email: FormValue;
  phone: FormValue;
  message: FormValue;
  privacyPolicy: string;
}

export interface Props {
  id: string;
  title: string;
  form: FormConfig;
}
const defaultFormConfig: FormConfig = {
  action: '#',
  services: [
    {
      name: 'Service A',
      value: 'a',
      icon: 'tabler:world-www',
      color: 'primary',
    },
    {
      name: 'Service B',
      value: 'b',
      icon: 'tabler:device-laptop',
      color: 'secondary',
    },
  ],
  name: {
    name: 'Name',
    placeholder: 'Ihr Name',
    optional: false,
  },
  company: {
    name: 'Firma',
    placeholder: 'Ihre Firma',
    optional: true,
  },
  email: {
    name: 'E-Mail',
    placeholder: 'Ihre E-Mail-Adresse',
    optional: false,
  },
  phone: {
    name: 'Telefon',
    placeholder: 'Ihre Telefonnummer',
    optional: true,
  },
  message: {
    name: 'Nachricht',
    placeholder: 'Ihre Nachricht',
    optional: false,
  },
  privacyPolicy:
    'Ich habe die <a href="/datenschutz" title="" class="font-medium text-gray-900 hover:no-underline underline dark:text-white">Datenschutzerklärung</a> gelesen und akzeptiere sie.',
};

const { id, title, form = defaultFormConfig } = Astro.props;
---

<SectionWrapper>
  <h1
    class="mb-12 text-4xl font-heading font-extrabold leading-none text-gray-900 md:text-5xl lg:text-6xl dark:text-white text-center"
    set:html={title}
  />
  <div class="max-w-3xl mx-auto mt-1 lg:mt-2">
    <form id={id} class="grid max-w-screen-md grid-cols-2 mx-auto gap-x-8 gap-y-6" action={form.action} method="POST">
      <div class="col-span-2 sm:col-span-2">
        <p class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Leistung auswählen:</p>
        <ul
          class="flex flex-wrap w-full gap-4 sm:grid-cols-1 md:grid-cols-3 lg:grid-cols-6 items-stretch justify-center"
        >
          {
            form.services.map((service: RadioOption) => (
              <li>
                <input
                  type="radio"
                  id={service.value}
                  name="service"
                  value={service.value}
                  class="hidden peer"
                  required
                />
                <label
                  for={service.value}
                  class={` h-full inline-flex items-center justify-between p-5 text-gray-500 bg-white border border-gray-200 rounded-lg cursor-pointer dark:hover:text-gray-300 dark:border-gray-700 peer-checked:bg-${service.color}-500  peer-checked:text-white dark:peer-checked:text-${service.color}-800 hover:text-${service.color}-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-gray-800 dark:hover:bg-gray-700 dark:peer-checked:hover:bg-${service.color}-400`}
                >
                  <div class="grid grid-cols-1 auto-rows-fr">
                    <div
                      class={` flex justify-center items-center mx-auto mb-4 w-10 h-10 rounded-lg bg-${service.color}-100 dark:bg-${service.color}-800 lg:h-12 lg:w-12`}
                    >
                      <Icon
                        name={service.icon}
                        class={`w-5 h-5 text-${service.color}-600 dark:text-${service.color}-300 lg:w-6 lg:h-6`}
                      />
                    </div>
                    <div
                      class="inline-flex items-center justify-center w-full text-lg font-semibold text-center"
                      set:html={service.name}
                    />
                  </div>
                </label>
              </li>
            ))
          }
        </ul>
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.name.name}
          <span class="text-sm">{form.name.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="text"
          id="name"
          name="name"
          class="block w-full p-3 text-sm text-gray-900 border border-gray-300 rounded-lg shadow-sm bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.name.placeholder}
          required={!form.name.optional}
        />
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="company-name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.company.name}
          <span class="text-xs">{form.company.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="text"
          id="company-name"
          name="company-name"
          class="block w-full p-3 text-sm text-gray-900 border border-gray-300 rounded-lg shadow-sm bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.company.placeholder}
          required={!form.company.optional}
        />
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.email.name}
          <span class="text-xs">{form.email.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="email"
          id="email"
          name="email"
          class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.email.placeholder}
          required={!form.email.optional}
        />
      </div>

      <div class="col-span-2 sm:col-span-1">
        <label for="phone-number" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
          {form.phone.name}
          <span class="text-xs">{form.phone.optional ? ' (optional)' : ''}</span>
        </label>
        <input
          type="number"
          id="phone-number"
          name="phone-number"
          class="block w-full p-3 text-sm text-gray-900 border border-gray-300 rounded-lg shadow-sm bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
          placeholder={form.phone.placeholder}
          required={!form.phone.optional}
        />
      </div>

      <div class="col-span-2">
        <label for="message" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400">
          {form.message.name}
          <span class="text-xs">{form.message.optional ? ' (optional)' : ''}</span>
        </label>
        <textarea
          id="message"
          rows="6"
          name="message"
          placeholder={form.message.placeholder}
          class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg shadow-sm border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        ></textarea>
      </div>

      <div class="col-span-2">
        <div class="flex items-start">
          <input
            type="checkbox"
            id="terms"
            name="terms"
            value=""
            class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
            required
          />
          <label
            for="terms"
            class="ml-2 text-sm font-normal text-gray-500 dark:text-gray-400"
            set:html={form.privacyPolicy}
          />
        </div>
      </div>

      <div class="flex justify-end col-span-2">
        <Button id={`submitButtonFrom${id}`} title="Angebot anfordern" submit={true} overwriteClass="me-0" />
        <Button
          id={`loadingButtonFrom${id}`}
          title="Angebot wird angefordert..."
          overwriteClass="hidden me-0"
          loading={true}
        />
      </div>
      <slot />
    </form>
  </div>
</SectionWrapper>
