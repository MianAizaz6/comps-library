---
import SectionWrapper from '~/layouts/SectionWrapper.astro';
import { Icon } from 'astro-icon/components';

export interface TimelineItem {
  title: string;
  description: string;
  icon?: string;
  iconBackground?: string;
}

export interface Props {
  title: string;
  description?: string;
  steps: TimelineItem[];
}

const { title, description, steps } = Astro.props;

const getIconBgClass = (bg: string = 'blue') => {
  const bgMap = {
    blue: 'bg-primary-600',
    green: 'bg-green-600',
    red: 'bg-red-600',
    yellow: 'bg-yellow-600',
    purple: 'bg-purple-600',
    gray: 'bg-gray-600',
  };

  return bgMap[bg] || 'bg-primary-600';
};
---

<SectionWrapper>
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold mb-4">{title}</h2>
      {description && <p class="text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">{description}</p>}
    </div>

    <div class="relative">
      <div
        class="absolute left-0 md:left-1/2 ml-4 md:ml-0 md:-translate-x-px top-0 h-full w-0.5 bg-gray-200 dark:bg-gray-700"
      >
      </div>

      <div class="space-y-12">
        {
          steps.map((step, index) => (
            <div class="relative flex flex-col md:flex-row items-start md:even:flex-row-reverse">
              <div class="absolute left-0 md:left-1/2 md:-translate-x-1/2 ml-4 md:ml-0 flex items-center justify-center w-8 h-8 rounded-full border-4 border-white dark:border-gray-900 bg-white dark:bg-gray-900 z-10">
                <div
                  class={`flex items-center justify-center w-6 h-6 rounded-full ${getIconBgClass(step.iconBackground)}`}
                >
                  {step.icon && <Icon name={step.icon} class="w-3 h-3 text-white" />}
                </div>
              </div>

              <div
                class={`md:w-1/2 ${index % 2 === 0 ? 'md:pr-12 md:text-right' : 'md:pl-12'} pt-2 md:pt-0 pl-12 md:pl-0`}
              >
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md">
                  <h3 class="text-xl font-bold mb-2">{step.title}</h3>
                  <p class="text-gray-600 dark:text-gray-400">{step.description}</p>
                </div>
              </div>

              <div class="hidden md:block md:w-1/2" />
            </div>
          ))
        }
      </div>
    </div>
  </div>
</SectionWrapper>
